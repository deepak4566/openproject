user: openproject
group: openproject
description: OpenProject
homepage: "https://www.openproject.org"
maintainer: "operations+packaging@openproject.com"
license: "GPL"
targets:
  centos-7: &centos7
    env:
      - BUNDLE_BUILD__PG="--with-pg-config=/usr/pgsql-13/bin/pg_config"
      - NODE_ENV=production
      - NPM_CONFIG_PRODUCTION=false
    dependencies:
      - epel-release
      - ImageMagick
      - unzip
      - poppler-utils
  centos-9:
    <<: *centos7
    env:
      - NODE_ENV=production
      - NPM_CONFIG_PRODUCTION=false
before_precompile: "packaging/setup"
after_precompile: "packaging/teardown"
services:
  - postgres
installer: https://github.com/pkgr/installer.git
wizards:
  - https://github.com/pkgr/addon-legacy-installer.git
  - ./packaging/addons/openproject-edition
  - https://github.com/pkgr/addon-postgres
  - https://github.com/pkgr/addon-apache2.git
  - ./packaging/addons/repositories
  - https://github.com/pkgr/addon-memcached.git
  - ./packaging/addons/openproject
buildpack: https://github.com/opf/heroku-buildpack-multi.git#master
env:
  - NODE_ENV=production
  - NPM_CONFIG_PRODUCTION=false
